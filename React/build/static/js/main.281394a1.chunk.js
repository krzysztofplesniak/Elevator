(this["webpackJsonpclient-react"]=this["webpackJsonpclient-react"]||[]).push([[0],{23:function(e,t,a){e.exports=a(47)},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(19),o=a.n(r),c=a(7),i=a.n(c),s=a(20),E=a(6),m=a(21),v=a.n(m),u=a(22),p=a(1),d=function(e,t){switch(t.type){case"GET_ELEVATORS":return Object(p.a)(Object(p.a)({},e),{},{loading:!1,elevators:t.payload});case"EXPECTED_TIME":return Object(p.a)(Object(p.a)({},e),{},{expectedTime:t.payload});case"ELEVATOR_IS_MOVING":return Object(p.a)(Object(p.a)({},e),{},{elevatorIsMoving:{elvId:t.payload,isMoving:!0}});case"ELEVATOR_IS_STOPPED":return Object(p.a)(Object(p.a)({},e),{},{elevatorIsMoving:{elvId:0,isMoving:!1},expectedTime:null});case"SET_ELEVATOR_HISTORY":return Object(p.a)(Object(p.a)({},e),{},{elevatorHistory:[].concat(Object(u.a)(e.elevatorHistory),[t.payload])});case"CALL_ELEVATOR":case"ELEVATOR_UP":case"ELEVATOR_DOWN":return Object(p.a)({},e);case"GET_ELEVATORS_ERORR":return Object(p.a)(Object(p.a)({},e),{},{error:t.payload});default:return e}},_={elevators:[],elevatorIsMoving:{elvId:0,isMoving:!1},expectedTime:null,elevatorHistory:[],loading:!0,error:null},g=Object(l.createContext)(_),O=function(e){var t=e.children,a=Object(l.useReducer)(d,_),r=Object(E.a)(a,2),o=r[0],c=r[1];Object(l.useEffect)((function(){Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT;var e=null;new EventSource("".concat(e,"/stream")).onmessage=function(e){var t=JSON.parse(e.data),a=t.id,l=t.floor,n=t.state,r=t.targetFloor;c("up"===n||"down"===n?{type:"ELEVATOR_IS_MOVING",payload:parseInt(a.slice(3,4))+1}:{type:"ELEVATOR_IS_STOPPED"}),m({id:a,floor:l,state:n,targetFloor:r}),u(r,l),p()}}),[]);var m=function(e){c({type:"SET_ELEVATOR_HISTORY",payload:e})},u=function(e,t){if(e){var a=Math.abs(e-t)+1;a&&c({type:"EXPECTED_TIME",payload:a})}},p=function(){var e=Object(s.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/elevators");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,c({type:"GET_ELEVATORS",payload:a});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(g.Provider,{value:{elevators:o.elevators,expectedTime:o.expectedTime,elevatorIsMoving:o.elevatorIsMoving,elevatorHistory:o.elevatorHistory,loadig:o.loading,error:o.error,getElevators:p,callElevator:function(e){v.a.put("/floor/".concat(e)),c({type:"CALL_ELEVATOR",payload:e})},elevatorUp:function(){console.log("Button UP"),c({type:"ELEVATOR_UP"})},elevatorDown:function(){console.log("Button DOWN"),c({type:"ELEVATOR_DOWN"})}}},n.a.createElement("div",{className:"container"},t))},f=function(){var e=Object(l.useContext)(g),t=e.expectedTime,a=e.elevatorIsMoving.isMoving;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"SkyTower Wroc\u0142aw"),a?n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,n.a.createElement("span",null,"Expected time ".concat(t," ")),1===t?"second":"seconds")):n.a.createElement("h2",null,"Elevator is waiting ..."))},y=a(3),T=function(){var e=Object(l.useContext)(g),t=e.elevators,a=e.loading,r=e.getElevators,o=e.elevatorIsMoving,c=o.elvId,i=o.isMoving,s=Object(E.a)(t,3),m=s[0],v=s[1],u=s[2];return Object(l.useEffect)((function(){r()}),[]),n.a.createElement(n.a.Fragment,null,!a&&t.length>0&&n.a.createElement("div",{className:"elevatorDisplay"},n.a.createElement("div",{className:"elevatorDisplay__panel"},n.a.createElement("div",{className:"elevatorDisplay__digitalDigit"},n.a.createElement(y.DigitalDigit,{digit:m.floor,color:1===c&&i?"red":"green",opacitySegment:.5})),n.a.createElement("p",{className:"elevatorDisplay__info"},m.state.toUpperCase())),n.a.createElement("div",{className:"elevatorDisplay__panel"},n.a.createElement("div",{className:"elevatorDisplay__digitalDigit"},n.a.createElement(y.DigitalDigit,{digit:v.floor,color:2===c&&i?"red":"green",opacitySegment:.5})),n.a.createElement("p",{className:"elevatorDisplay__info"},v.state.toUpperCase())),n.a.createElement("div",{className:"elevatorDisplay__panel"},n.a.createElement("div",{className:"elevatorDisplay__digitalDigit"},n.a.createElement(y.DigitalDigit,{digit:u.floor,color:3===c&&i?"red":"green",opacitySegment:.5})),n.a.createElement("p",{className:"elevatorDisplay__info"},u.state.toUpperCase()))))},b=a(49),D=function(e){var t=e.elevator,a=t.id,l=t.floor,r=t.state,o=t.targetFloor;return n.a.createElement("div",{className:"elevatorList__element"},n.a.createElement("div",{className:"elevatorList__element--span"},"Elevator",n.a.createElement("span",{className:"elevatorList__element--bold"},parseInt(a.slice(3,4))+1)),n.a.createElement("div",{className:"elevatorList__element--span"},"Floor #",n.a.createElement("span",{className:"elevatorList__element--bold"},l)),n.a.createElement("div",{className:"elevatorList__element--targetFloor "},"Target floor #",n.a.createElement("span",{className:"elevatorList__element--bold"},o)),n.a.createElement("div",{className:"elevatorList__element--direction"},n.a.createElement("span",null,r.toUpperCase())))},L=function(){var e=Object(l.useContext)(g).elevatorHistory,t=null;return t=e.length>6?e.slice(e.length-7,e.length):e,n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",null,"History of elevators calling"),n.a.createElement("div",{className:"elevatorList"},t.map((function(e){return n.a.createElement(D,{key:Object(b.a)(),elevator:e})}))))},N=function(){var e=Object(l.useContext)(g).callElevator;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",null,"Remote panel"),n.a.createElement("div",{className:"remotePanel"},[1,2,3,4,5,6,7,8].map((function(t){return n.a.createElement("div",{key:t,className:"remotePanel__control",onClick:function(){e(t)}},n.a.createElement(y.DigitalDigit,{digit:t,color:"blue",opacitySegment:.5}))}))))};a(46);var j=function(){return n.a.createElement(O,null,n.a.createElement(f,null),n.a.createElement(T,null),n.a.createElement(N,null),n.a.createElement(L,null))};o.a.render(n.a.createElement(j,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.281394a1.chunk.js.map